---
name: verification-loop
description: コード変更後の品質検証ループ。ビルド、型チェック、リント、テスト、セキュリティスキャン、差分レビューを体系的に実行する。
model: sonnet-4-5
---

# 検証ループ

## 実行タイミング

- 機能実装完了後
- 大きなコード変更後
- PR作成前
- リファクタリング後

## 6段階の検証フェーズ

### Phase 1: ビルド検証

```bash
npm run build
# または
pnpm build
```

ビルドが失敗したら次に進まない。エラーを修正してから再実行。

### Phase 2: 型チェック

```bash
npx tsc --noEmit
```

型エラーをすべて報告し、重要なものは修正する。

### Phase 3: リントチェック

```bash
npx biome check .
# または
npm run lint
```

自動修正可能なものは修正、それ以外は報告。

### Phase 4: テスト実行

```bash
npm run test -- --coverage
```

- カバレッジ80%以上を確認
- 失敗テストがあれば修正

### Phase 5: セキュリティスキャン

確認事項:
- ハードコードされた秘密情報がないか
- `console.log` がプロダクションコードに残っていないか
- `.env` ファイルがコミット対象でないか
- 依存パッケージの脆弱性: `npm audit`

### Phase 6: 差分レビュー

```bash
git diff --stat
git diff
```

- 意図しない変更がないか
- エラーハンドリングの漏れがないか
- エッジケースが考慮されているか

## 検証レポート形式

```
## 検証レポート
- [x] ビルド: 成功
- [x] 型チェック: エラー0件
- [x] リント: 警告2件（軽微）
- [x] テスト: 全件パス（カバレッジ85%）
- [x] セキュリティ: 問題なし
- [x] 差分レビュー: 問題なし

PR準備完了: はい
```

## 継続モード

長時間の開発セッションでは、大きな変更のたびに検証ループを回す。
